<%- contentFor('body') %>

  <div class="w-full">
    <div class="px-4 md:px-6 lg:px-8">
      <h1 class="text-2xl md:text-3xl font-bold mb-4"><%= part.title %></h1>

      <div id="story-content" class="prose prose-invert max-w-none">
        <%- part.content %>
      </div>

      <div class="mt-6">
        <a class="text-halloween-orange underline" href="/stories"><%= (lang === 'fr') ? 'Retour Ã  toutes les parties' : (lang === 'en') ? 'Back to all parts' : 'Terug naar alle delen' %></a>
      </div>
    </div>
  </div>

<%- contentFor('extraScripts') %>
<script>
  // Enforce unlock on the part view as well
  (function(){
    try {
      const partId = <%= part.id %>;
      const unlocked = JSON.parse(localStorage.getItem('unlockedStoryParts') || '[]');
      if (!unlocked.includes(Number(partId))) {
        alert('Scan the QR code to unlock this story part.');
        window.location.replace('/stories');
      }
    } catch (_) {}
  })();
</script>

