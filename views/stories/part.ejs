<%- contentFor('body') %>

  <div class="w-full">
    <div class="px-4 md:px-6 lg:px-8">
      <h1 class="text-2xl md:text-3xl font-bold mb-4"><%= part.title %></h1>

      <div id="story-content" class="prose prose-invert max-w-none mb-6">
        <%- part.content %>
      </div>

      <h2 class="text-2xl md:text-3xl mb-4">
        <%= (lang==='fr' ) ? 'Mission' : (lang==='en' ) ? 'Assignment' : 'Opdracht' %>
      </h2>
      <div  class="prose prose-invert max-w-none mb-6">
        <%- part.assignment %>
      </div>


      <div class="flex flex-col items-center justify-center min-h-[150px] mb-8">

        <button id="reveal-button"
          class="bg-halloween-orange hover:bg-orange-600 text-white font-bold py-3 px-6 rounded-lg transition duration-300 shadow-xl text-lg uppercase tracking-wider">
          <%= (lang==='fr' ) ? 'Révéler le Mot Magique' : (lang==='en' ) ? 'Reveal Magic Word' : 'Onthul Toverwoord' %>
        </button>

        <div id="magic-word-display" class="hidden text-center mt-6">
          <p class="text-5xl md:text-6xl font-extrabold text-halloween-orange uppercase tracking-widest animate-pulse">
            <%- part.magicWord %>
          </p>
        </div>
      </div>

      <div class="mt-6">
        <a class="text-halloween-orange underline" href="/stories"><%= (lang === 'fr') ? 'Retour à toutes les parties' : (lang === 'en') ? 'Back to all parts' : 'Terug naar alle delen' %></a>
      </div>
    </div>
  </div>

<%- contentFor('extraScripts') %>
<script>    
  (function(){
    try {
      const partId = <%= part.id %>;
      const unlocked = JSON.parse(localStorage.getItem('unlockedStoryParts') || '[]');
      if (!unlocked.includes(Number(partId))) {
        alert('Scan the QR code to unlock this story part.');
        window.location.replace('/stories');
      }

      const revealButton = document.getElementById('reveal-button');
      const magicWordDisplay = document.getElementById('magic-word-display');

      revealButton.addEventListener('click', () => {
        revealButton.classList.add('hidden');
        magicWordDisplay.classList.remove('hidden');
      });

    } catch (_) { }
  })();
</script>

